# 네트워크 (Network)
1. 컴퓨터 네트워크와 인터넷

1.1 인터넷 이란?

1.1.1 구성요소로 본 인터넷
- 종단 시스템 : 통신 링크와 패킷 스위치의 네트워크로 연결됨
  - ISP를 통해 인터넷 접속, 각 ISP는 패킷 스위치와 통신 링크로 이루어진 네트워크
  - ISP는 종단 시스템에게 다양한 네트워크 접속을 제공, 웹 사이트를 인터넷에 직접 연결하도록 CP에 인터넷 접속을 제공
  - 인터넷은 종단 시스템을 서로 연결하는 것이므로 종단 시스템에 접속을 제공하는 ISP들도 서로 연결되어야 함
- 패킷 스위치
  - 라우터 : 네트워크 코어에서 사용
  - 링크 계층 스위치 : 보통 액세스 네트워크에서 사용
  - 두 형태 스위치는 최종 목적지 방향으로 패킷을 전달 
1.1.2 서비스 측면에서 본 인터넷
- 애플리케이션에 서비스를 제공하는 인프라 구조서 인터넷을 기술 
- 인터넷 애플리케이션은 종단 시스템에서 수행
1.1.3 프로토콜
- 어떤 일을 수행하려면 둘 이상의 통신 개체가 함께 인식하는 프로토콜이 필요
- 프로토콜은 둘 이상의 통신 개체 간에 교환되는 메시지 포맷과 순서뿐 아니라, 메시지 송수신과 다른 이벤트에 따른 행동들을 정의

1.2 네트워크의 가장자리

1.2.1 접속 네트워크
- 종단 시스템을 그 종단 시스템으로부터 다른 먼 거리의 종단 시스템까지 경로상에 있는 첫 번째 라우터에 연결하는 네트워크
- 가정 접속(DSL, 케이블, FTTH, 다이얼-업 그리고 위성)    
  - DSL은 다운 스트림과 업 스트림의 전송 속도가 다르기 때문에 접속이 비대칭
  
    ![ex_screenshot](/res/nt1.png)
    - 텔코의 기존로컬 전화 기반 구조 이용
    - 스플리터는 가정에 도착하는 데이터와 전화 신호를 분리하고 데이터 신호를 DSL 모뎀으로 전송
    - 텔코 쪽의 CO에 있는 DSLAM은 데이터와 전화 신호르 분리하고 데이터를 인터넷으로 송신
  - 케이블 인터넷 접속은 케이블 TV 기반 구조 이용
  
    ![ex_screenshot](/res/nt2.png)
    - 케이블 모뎀이 필요하고 접속은 비대칭이며 다운 스트림 채널이 업스트림 채널보다 빠른 전송속도가 할당
    - CMTS는 DSL의 DSLAM과 유사한 기능을 제공
    - 공유 방송 매체라는 특성이 있다
    - 여러 사용자가 다운 스트림 채널에 동시 수신하면, 실제 수신율은 다운 스트림 전송률보다 작아짐
- 기업접속 (이더넷과 와이파이)
  - LAN은 일반적으로 종단 시스템을 가장자리 라우터에 연결하기 위해 사용
  - 이더넷은 이더넷 스위치와 연결하기 위해 꼬임쌍선을 이용하고 더 큰 인터넷으로 연결
  - 무선 랜 환경에서는 기업 네트워크에 연결된 AP로 패킷을 송/수신하고, AP는 유선 네트워크에 다시 연결, 사용자들은 AP의 수십m 반경 내에 있어야함.
- 광역 무선 접속(3G, LTE)
  - 이동 전화망 사업자들이 운영하는 기지국을 통해 패킷을 송수신하는 데 사용하는 것과 같은 무선 기반구조 채택
  - 와이파이와 달리 기지국의 수십km 반경 내에 있으면 됨
  
1.3 네트워크 코어

1.3.1 패킷 교환
- 패킷은 통신 링크와 패킷 스위치를 거치게 되며, 링크의 최대 전송속도와 같은 속도로 각 통신 링크상에서 전소오
- 패킷 스위치가 R bit/sec의 속도로 링크상에서 L bits 패킷 송신하면, 패킷을 전송하는 데 걸리는 시간은 L/R 초

- 저장 후 전달 : 스위치가 출력 링크로 패킷의 첫 비트를 전송하기 전에 전체 패킷을 받아야 함을 의미

  ![ex_screenshot](/res/nt3.png)
  - 라우터가 패킷의 모든 비트를 수신 후 출력 링크로 패킷을 전송하기 시작
  - 라우터는 입력되는 패킷을 출력 링크로 교환한다
  - d 종단간 지연 = N * L/R
  
- 큐잉 지연과 패킷 손실
  - 각 링크에 대해 패킷 스위치는 출력 버퍼를 갖고 있으며 송신하려는 패킷을 저장하고 있다
  - 도착하는 패킷이 왔을 때 다른 패킷이 전송 중이면 출력 버퍼에서 대기 => 큐잉 지연을 겪음
  - 큐잉 지연은 가변적이고 네트워크의 혼잡 정도에 따른다
  - 도착 시 다른 패킷으로 가득 차있을 경우 패킷 손실이 발생할 수 있다 => 도착 패킷 OR 대기 패킷을 폐기
  
  ![ex_screenshot](/res/nt4.png)
  
- 전달 테이블과 라우팅 프로토콜
  - 인터넷에서 모든 종단 시스템은 IP 주소를 갖는다
  - 소스 종단 시스템이 패킷을 목적 종단 시스템으로 보낼 때 소스는 패킷의 헤더에 목적지 IP 주소를 포함
  - 라우터는 패킷의 목적지 주소의 일부를 조사하고 패킷을 이웃 라우터로 전달
  - 각 라우터는 목적지 주소를 라우터의 출력 링크로 맵핑하는 전달 테이블을 랒고 있다
  - 패킷 라우터 도착 시, 라우터는 주소 조사후 목적지 주소를 이용해 전달 테이블을 검색하고 패킷을 출력 링크로 보냄

1.3.2 회선 교환
- 링크와 스위치의 네트워크를 통해 데이터를 이동시키는 방식 => 회선 교환, 패킷 교환
- 회선 교환은 종단 시스템 간 통신을 제공하기 위해 경로 상 필요 자원은 통신 세션 동안 예약
  - 정보 보내기 전 송,수신자 간 연결을 설정해야 한다
  - 송,수신자 간의 경로에 있는 스위치들이 해당 연결 상태를 유지해야 하는 연결(회선)
  - 연결이 이루어지는 동안 네트워크 링크에 일정한 전송률을 예약한다
  - 송신자는 수신자에게 보장된 일정 전송률로 데이터를 보낼 수 있다
- 패킷 교환은 자원을 예약하지 않음
  - 링크중 하나가 혼잡하다면 송신 쪽 버퍼에서 기다려야하고 지연이 발생
  - 일정 시간 내에 전달하는 것을 보장하지 않음

1.4 패킷 교환 네트워크에서 지연, 손실과 처리율

1.4.1 패킷 교환 네트워크에서의 지연 개요 
- 처리 지연 : 패킷 헤더를 조사하고 패킷을 어디로 보낼 지 결정하는 시간
- 큐잉 지연 : 큐에 저장되어 링크로 전송되기를 기다리는 다른 패킷 수에 의해 결정된다
- 전송 지연 : 패킷의 모든 비트를 링크로 밀어내는 데 필요한 시간(L/R -> 패킷 길이/전송률), 라우터가 패킷을 내보내는 데 필요한 시간 
- 전파 지연 : 링크의 처음부터 라우터까지 전파에 필요한 시간 (d/s -> 라우터 간 거리 / 링크 전파 속도), 한 라우터에서 다음라우터로 전파되는 데 걸리는 시간 
- 전체 노드 지연 = 처리 지연 + 큐잉 지연 + 전송 지연 + 전파 지연 

1.4.2 큐잉 지연과 패킷 손실
- R: 전송률, L: 패킷 길이, a: 패킷이 큐에 도착하는 평균율 -> La/R : 비트가 큐에 도착하는 평균율 
- 트랙픽 강도(La/R)은 큐잉 지연 정도를 측정하는 데 매우 중요
- La/R > 1이면, 큐는 끝없이 증가하고 큐잉 지연은 무한대에 도달
- La/R <=1
  - 주기적 도착 -> 큐잉 지연 없음
  - 몰려서 도착 -> 상당한 평균 큐잉 지연 발생 
- 패킷을 저장할 수 없는 경우 패킷을 버리게 된다, 손실 패킷의 비율은 트래픽 강도가 클수록 증가

1.4.3 종단 간 지연
- 종단 간 지연 = N(처리 지연 + 전송 지연 + 전파 지연)

1.4.4 컴퓨터 네트워크에서 처리율 
- 병목 링크의 전송률이 처리율 ( 여러개 링크로 구성된 경우 가장 작은 값의 전송률이 처리율이 된다 )

1.5 프로토콜 계층과 서비스 모델 
  
  ![ex_screenshot](/res/nt5.png)
  ![ex_screenshot](/res/nt6.png)

- 애플리케이션 계층 : 네트워크 애플리케이션과 애플리케이션 계층 프로토콜이 있는 곳
  - HTTP, SMTP, FTP 등 많은 프로토콜 포함
  - 정보 패킷 : 메시지
- 트랜스포트 계층 : 클라이언트와 서버 간 애플리케이션 계층 메시지를 전송하는 서비스 제공
  - TCP : 연결지향형 서비스 제공, 메시지의 전달 보장과 흐름제어 포함 
  - UDP : 비연결형 서비스 제공. 신뢰성, 흐름제어, 혼잡제어를 제공하지 않는 간단한 서비스 
  - 정보 패킷 : 세그먼트
- 네트워크 계층 : 한 호스트에서 다른 호스트로 데이터그램을 라우팅하는 책임을 진다.
  - 출발지 트랜스포트 계층에서 목적지 트랜스포트 계층까지 세그먼트를 운반하는 서비스 제공
  - IP 프로토콜
  - 출발지와 목적지 사이에서 데이터그램이 이동하는 경로를 결정하는 라우팅 프로토콜을 포함
  - 정보 패킷 : 데이터그램
- 링크 계층
  - 네트워크 계층은 출발지와 목적지 간 패킷 스위치를 통해 데이터그램을 라우트 한다
  - 경로상 한 노드에서 다른 노드로 패킷을 이동하기 위해 네트워크 계층은 링크 계층 서비스에 의존해야 한다.
  - 패킷 : 프레임
- 물리 계층
  - 프레임 내부의 각 비트를 한 노드에서 다음 노드로 이동하는 것이 기능이다.
  - 실제 전송 매체에 의존한다.
- OSI 모델
  - 프레젠테이션 계층 : 통신하는 애플리케이션들이 교환되는 데이터의 의미를 해석하도록 하는 서비스 제공
    - 데이터 압축, 데이터 암호화를 포함
  - 세션 계층 : 데이터 교환의 경계와 동기화를 제공하는데, 체킹포인트와 회복 방법을 세우는 수단을 포함

1.6 공격받는 네트워크
- 나쁜 친구들은 인터넷을 통해 당신의 호스트에 맬웨어를 침투시킬 수 있다.
  - 맬웨어는 사적인 정보를 모으는 스파이 웨어를 설치해 정보를 모아 나쁜 친구들에게 다시 보낸다.
    - 면역되지 않는 호스트는 비슷한 면역되지 않는 장치들로 구성된 네트워크(봇넷)에 등록 될 수 있다.
    - 목표로 하는 호스트에 대해 스팸 전자메일 분배 OR 분산 DoS 공격을 위해 봇넷을 제어하고 이용한다.
  - 맬웨어는 자기복제를 한다 -> 바이러스 OR 웜의 형태로 퍼질 수 있다.
  - 웜은 사용자의 직접적인 상호작용 없이 장치에 침투하는 맬웨어이다. 
- 나쁜 친구들은 서버와 네트워크 기반구조를 공격할 수 있다.
  - DoS 공격은 네트워크, 호스트 OR 다른 기본구조의 요소들을 정상적인 사용자들이 사용할 수 없게 하는 것
    - 취약성 공격 : 목표 호스트에서 수행되는 공격받기 쉬운 애플리케이션or운영체제에 교묘한 메시지를 보내는 것을 포함하고 서비스가 중단되거나 호스트가 멈출 수 있다.
    - 대역폭 플러딩 : 목표 호스트의 접속 링크가 동작하지 못하게 많은 패킷을 보내 정당 패킷이 서버에 도달하지 못하도록 한다.
    - 연결 플러딩 : 목표 호스트에 반열림 or 전열림된 tcp연결을 설정 -> 호스트는 가짜 연결을 처리하느라 정상적인 연결을 받아들이는 것을 중단하게 된다.
- 나쁜 친구들은 패킷을 탐지할 수 있다.
  - 수동적인 수신자를 무선 전송장치 근처에 두어 전송되는 모든 패킷의 사본을 얻을 수 있다.
  - 패킷에는 민감한 정보를 포함할 수 있다
  - 지나가는 모든 패킷의 사본을 기록하는 수동적인 수신자를 패킷 스니퍼라 한다.
- 나쁜 친구들은 당신이 신뢰하는 사람인 것처럼 위장할 수 있다.
  - IP 스푸핑 : 거짓 출발지 주소를 가진 패킷을 인터넷으로 보내는 능력 -> 한 사용자가 다른 사용자인 것처럼 행동
  -> 이 문제를 해결하기위해 종단 인증 방법이 필요하다. 

2. 애플리케이션 계층

2.1 네트워크 애플리케이션의 원리

2.1.1 네트워크 애플리케이션 구조
- 클라이언트/서버 구조
  - 항상 켜져 있는 호스트 -> 서버
  - 클라이언트라는 다른 많은 호스트의 요청을 받는다
  - 서버가 고정 IP 주소라는 잘 알려진 주소를 갖는다
  - 서버는 항상 동작하므로 클라이언트는 서버 주소로 패킷을 보내 항상 서버에 연결할 수 있다
  - 웹, 파일 전송, 원격 로그인, 전자메일
- P2P 구조
  - 항상 켜져있는 기반구조 서버에 최소로 의존
  - 애플리케이션은 피어라는 간헐적으로 연결된 호스트 쌍이 서로 직접 통신하도록 한다
  - 트래픽 집중적인 애플리케이션들이 사용
  - 자가 확장성
    - 각 피어들은 or 파일을 다른 피어들에게 분배함으로써 서비스 능력을 추가
  - 비요 효율적
    - 상당한 서버 기반구조와 서버 대역폭을 요구하지 않음
  - 세가지 주요 과제
    - ISP 우호적 
      - 대부분 가정 ISP들은 '비대칭' 대역폭 방식을 제공
      - 업스트릶 트래픽보다 다운스트림 트래픽에 대역폭을 더 많이 제공
      - ISP에 상당한 부하를 야기한다
    - 보안
      - 고도의 분산 및 개방성으로 인해 P2P 응용은 보안에 문제를 야기할 수 있다
    - 보상
      - P2P 응용의 성공은 응요에 대역폭, 저장 장치, 계산 자원을 자발적으로 제공하도록 사용자들을 설득해야한다
  
2.1.2 프로세스 간 통신
- 2개의 다른 종단 시스템에서 프로세스는 컴퓨터 네트워크를 통한 메시지 교환으로 서로 통신
- 클라이언트와 서버 프로세스
  - 웹 애플리케이션에서 클라이언트 브라우저 프로세스는 웹 서버 프로세스와 메시지를 교환한다
  - P2P 파일 공유 시스템에서는 한 피어의 프로세스에서 다른 피어의 프로세스로 파일을 전송
  - P2P 파일 공유에서 파일을 내려받는 피어를 클라이언트, 파일을 올리는 피어를 서버라 한다
  - 두 프로세스 간의 통신 세션에서 통신을 초기화(다른 프로세스와 세션을 시작하려고 접속을 초기화)하는 프로세스 -> 클라이언트
  - 세션을 시작하기 위해 접속을 기다리는 프로세스 -> 서버
  
- 프로세스와 컴퓨터 네트워크 사이의 인터페이스
  - 프로세스는 소켓을 통해 네트워크로 메시지를 보내고 받는다
  - 소켓은 호스트의 애플리케이션 계층과 트랜스포트 계층 간의 인터페이스
  - 소켓은 네트워크 애플리케이션이 인터넷에 만든 프로그래밍 인터페이스 -> 애플리케이션과 네트워크 사이의 API
  
- 주소화 프로세스
  - 한 호스트상에서 수행되고 있는 프로세스가 패킷을 다른 호스트에서 수행되고 있는 프로세스로 패킷을 보내기 위해 수신 프로세스가 주소를 갖고 있을 필요가 있다
  - 수신 프로세스를 식별하기 위해 호스트의 주소와 목적지 호스트 내의 수신 프로세스를 명시하는 식별자가 명시될 필요가 있다
  - 인터넷에서 호스트는 IP 주소로 식별된다
  - 

